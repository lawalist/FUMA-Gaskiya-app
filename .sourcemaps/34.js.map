{"version":3,"sources":["../../src/pages/security/users-management/users-management.ts","../../src/pages/security/users-management/users-management.module.ts"],"names":[],"mappings":"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","file":"34.js","sourcesContent":["import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController, LoadingController, ViewController } from 'ionic-angular';\nimport { PouchdbProvider } from '../../../providers/pouchdb-provider';\nimport { Validators, FormBuilder } from '@angular/forms';\n\n/**\n * Generated class for the UsersManagementPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-users-management',\n  templateUrl: 'users-management.html',\n})\nexport class UsersManagementPage {\n  selectedStyle: any = 'liste';\n  users: any = [];\n  allUsers: any = [];\n  page: any = 'liste';\n  user: any = {};\n  userForm: any;\n  nom: any;\n  prenom: any;\n  sex: any;\n  roles: any = [];\n  codes_unions: any = [];\n  codes_ops: any = [];\n  unions: any = [];\n  ops: any = [];\n  protocoles: any = [];\n  ops_unions: any = [];\n  protocoles_annee: any = [];\n  annees_essais: any = [];\n  codes_protocoles: any = [];\n  sites: any = [];\n  typeRecherche: any = 'name';\n  annees: any = [];\n\n  constructor(public navCtrl: NavController, public alertCtl: AlertController, public loadingCtl: LoadingController, public formBuilder: FormBuilder, public navParams: NavParams, public viewCtrl: ViewController, public servicePouchdb: PouchdbProvider) {\n  }\n\n\n  initForm(){\n    this.userForm = this.formBuilder.group({\n      nom: [''],\n      prenom: [''],\n      //username: ['', Validators.required],\n      //email: [this.user.email],\n      //mdpass: ['', Validators.required],\n      //confmdpass: ['', Validators.required],\n      //date: [this.user.date, Validators.required],\n      sex: [''],\n      roles: [''],\n      codes_unions: [''],\n      codes_ops: [''],\n      annees_essais: [''],\n      codes_protocoles: [''],\n      sites: ['']\n    })\n  }\n\n  /*ionViewDidLoad() {\n    console.log('ionViewDidLoad UsersManagementPage');\n  }*/\n\n  ionViewDidEnter(){\n    this.servicePouchdb.getAllUsers('admin', 'admin').then((users) => {\n      if(users){\n        this.users = users;\n        this.allUsers = users;\n      }\n    });\n\n    this.getAllUnions();\n    this.getAllOps();\n    this.getAllProtocoles();\n  }\n\n  chargerOP(codes_unions){\n    this.ops_unions = [];\n    let new_ops: any = [];\n    this.ops.forEach((op) => {\n      if(codes_unions && codes_unions.length > 0 && codes_unions.indexOf(op.doc.data.code_union) !== -1){\n        new_ops.push(op)\n      }\n    });\n\n    this.ops_unions = new_ops;\n  }\n\n  detail(user){\n    this.user = user;\n    this.page = 'detail'\n  }\n\n  chargerProtocoles(annees_essais){\n    this.protocoles_annee = [];\n    let new_protocoles: any = [];\n    this.protocoles.forEach((prot) => {\n      if(annees_essais && annees_essais.length > 0 && annees_essais.indexOf(prot.doc.data.annee) !== -1){\n        new_protocoles.push(prot)\n      }\n    });\n\n    this.protocoles_annee = new_protocoles;\n  }\n\n  editer(user){\n    this.userForm = null;\n    this.annees = [];\n    this.initForm();\n    for(let i=0; i<=50; i++){\n      this.annees.push(2000 + i)\n    } \n    this.nom = user.nom;\n    this.prenom = user.prenom;\n    this.sex = user.sex;\n    this.roles = user.roles;\n    this.codes_unions = user.codes_unions;\n    this.codes_ops = user.codes_ops;\n    this.annees_essais = user.annees_essais;\n    this.codes_protocoles = user.codes_protocoles;\n    this.sites = user.sites;\n\n    this.chargerOP(this.codes_unions)\n    this.chargerProtocoles(this.annees_essais)\n\n    this.page = 'edite'\n  }\n\n  getAllUnions(){\n    this.servicePouchdb.managerGetAllUnions().then((unions) => {\n      this.unions = unions;\n    }).catch((err) => {\n      alert(err)\n    })    \n  }\n\n  getAllOps(){\n    this.servicePouchdb.managerGetAllOps().then((ops) => {\n      this.ops = ops;\n      //this.chargerOP(this.codes_unions)\n    }).catch((err) => {\n      alert(err)\n    })    \n  }\n\n  \n  getAllProtocoles(){\n    this.servicePouchdb.managerGetAllProtocoles().then((protocoles) => {\n      this.protocoles = protocoles;\n      //this.chargerOP(this.codes_unions)\n    }).catch((err) => {\n      alert(err)\n    })    \n  }\n  sauvegarder(){\n    let loading = this.loadingCtl.create({\n      content: 'Mise à jour de l\\'utilisateur en cours...'\n    });\n    loading.present();\n    let user = this.userForm.value;\n    let grand_user = this.user;\n    grand_user.nom = user.nom;\n    grand_user.prenom = user.prenom;\n    grand_user.sex = user.sex;\n    grand_user.roles = user.roles;\n    if(user.codes_unions)\n      grand_user.codes_unions = user.codes_unions;\n    else\n    grand_user.codes_unions = [];\n    \n    if(user.codes_unions && user.codes_unions.length > 0){\n      grand_user.codes_ops = user.codes_ops;\n    }else{\n      grand_user.codes_ops = [];\n    }\n    grand_user.annees_essais = user.annees_essais;\n    if(user.annees_essais && user.annees_essais.length > 0){\n      grand_user.codes_protocoles = user.codes_protocoles;\n    }else{\n      grand_user.codes_protocoles = [];\n    }\n    \n    user.sites = [];\n    this.unions.forEach((u) => {\n      if(user.codes_unions.indexOf(u.doc.data.code_union) !== -1){\n        user.sites.push(u.doc.data.commune + '-' + u.doc.data.commune_nom)\n      }\n    });\n\n    grand_user.sites = user.sites;\n\n    this.servicePouchdb.managerUpdateUser('admin','admin',grand_user).then((res) => {\n      loading.dismiss();\n \n      //user._id = res.id;\n      grand_user._rev = res.rev;\n      for(let i = 0; i < this.users.length; i++){\n        if(this.users[i].email == grand_user.email){\n          this.users[i] = grand_user;\n          break;\n        }\n      }\n\n      this.allUsers = this.users;\n      this.user = grand_user;\n      this.reninitVar();\n      this.page = 'detail';\n    }).catch((err) => {\n       loading.dismiss();\n      alert('erreur '+err);\n    })\n    \n  }\n\n  reninitVar(){\n    this.nom = null;\n    this.prenom = null;\n    this.sex = null;\n    this.roles = [];\n    this.codes_unions = [];\n    this.codes_ops = [];\n    this.annees_essais = [];\n    this.codes_protocoles = [];\n    this.sites = [];\n  }\n\n  annuler(){\n\n    if(this.page === 'detail'){\n      this.page = 'liste';\n    }else if(this.page === 'edite'){\n      this.reninitVar();\n      this.page = 'detail';\n    }else{\n      this.viewCtrl.dismiss();\n    }\n  }\n\n\n  supprimer(user){\n    let e: any = {};\n    let alert = this.alertCtl.create({\n      title: 'Suppression utilisateur',\n      message: 'Etes vous sûr de vouloir supprimer cet utilisateur ?',\n      buttons:[\n        {\n          text: 'Non',\n          handler: () => console.log('suppression annulée')\n \n        },\n        {\n          text: 'Oui',\n          handler: () => {\n            this.servicePouchdb.managerDeleteUser('admin', 'admin', user).then((res) => {\n              this.users.splice(this.users.indexOf(user), 1);\n              this.allUsers = this.users;\n              this.page = 'liste';\n              \n            }, err => {\n              console.log(err)\n            }) ;\n            \n          }\n        }\n      ]\n    });\n\n    alert.present();\n  }\n\n  getItems(ev: any) {\n    // Reset items back to all of the items\n    //this.membres = this.allMembres;\n\n    // set val to the value of the searchbar\n    let val = ev.target.value;\n\n    // if the value is an empty string don't filter the items\n    if (val && val.trim() != ''){\n      this.users = this.allUsers.filter((item) => {\n        if(this.typeRecherche === 'name'){\n          return (item.name.toLowerCase().indexOf(val.toLowerCase()) > -1);\n        }else if(this.typeRecherche === 'nom'){\n          if(item.nom){\n            return (item.nom.toLowerCase().indexOf(val.toLowerCase()) > -1);\n          }\n        }else if(this.typeRecherche === 'prenom'){\n          if(item.prenom){\n            return (item.prenom.toLowerCase().indexOf(val.toLowerCase()) > -1);\n          }\n          \n        }  \n      });\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/users-management/users-management.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { UsersManagementPage } from './users-management';\n\n@NgModule({\n  declarations: [\n    UsersManagementPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UsersManagementPage),\n  ],\n  exports: [UsersManagementPage] \n})\nexport class UsersManagementPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/users-management/users-management.module.ts"],"sourceRoot":""}